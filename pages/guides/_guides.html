<div id="guide-listings">
  <div class="row equal">
    <div class="col-sm-2">
        <div id="toc" class="categories js-scroll-with-user" data-scroll-after-selector=".cloud-filter" data-scroll-until-selector=".guide-listing">
          <ul class="sectlevel1">
            {% for category in site.categories %}
              {% capture category_name %}{{ category | first }}{% endcapture %}
                <li class="{{ category_name | slugify }}">
                    <a href="#{{category_name | slugify}}" ga-on="click" ga-event-category="guides-listings-{{ page.path | slugify}}" ga-event-action="category-{{ category_name | slugify }}">{{category_name}}</a>
                </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    <div class="col-sm-8">
      <div class="row">
        <div class="guide-listing js-scroll-spy" data-scroll-spy-nav-selector="#toc">
          {% for category in site.categories %}
            {% capture category_name %}{{ category | first }}{% endcapture %}
            <h3 class="category-head">{{ category_name }}</h3>
            {% for post in site.categories[category_name] %}
              <div class="guide-card card-shadow" id="{{ post.title | slugify | downcase | split: ' ' | join: '-' | append: '-card' }}">
                <div class="card" ga-on="click" ga-event-category="guide-{{ post.title | slugify }}" ga-event-action="guide-click">
                  <div class="row no-padding">
                    <div class="col-xs-2 img-inner no-padding">
                      <img src="{{ post.image }}" alt="card image" class="img-center">
                    </div>
                    <a href="{{ post.url }}">
                      <div class="col-xs-10 card-body guide-card-description float-right">
                        <h5 class="card-title"><b>{{ post.title }}</b></h5>
                        <p class="card-text">{{ post.excerpt | strip_html }}</p>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            {% endfor %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>
<script>
    window.guideEntries = [
        {% for post in site.posts %}
            {
                "id"       : "{{ post.title | slugify | strip_html | downcase | split: ' ' | join: '-' | append: '-card' }}",
                "title"    : "{{ post.title | strip_html | escape | downcase}}",
                "category" : "{{post.category | downcase | slugify}}",
                "excerpt" : "{{post.excerpt | strip_html | strip_newlines | escape | downcase}}",
                "content"  : {{ post.content | strip_html | strip_newlines | jsonify | downcase }},
                "tags"     : "{{ post.tags | join: ', ' | downcase}}",
                "cloud"     : "{{ post.cloud | join: ', ' | downcase}}"
            } {% unless forloop.last %},{% endunless %}
        {% endfor %}
    ];
</script>
